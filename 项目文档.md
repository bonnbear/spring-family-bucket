# Spring 全家桶项目文档

## 1. 项目概览

- 项目名称: `spring-family-bucket`
- 项目类型: Maven + Spring Boot 单体服务
- JDK 版本: `17`
- Spring Boot 版本: `3.3.8`
- 包名根路径: `com.example.springfamily`

## 2. 技术栈

### 2.1 后端框架

- Spring Boot 3.3.8
- Spring Web (`spring-boot-starter-web`)
- Spring Validation (`spring-boot-starter-validation`)
- Spring Data JPA (`spring-boot-starter-data-jpa`)
- Spring Security (`spring-boot-starter-security`)
- Spring Cache (`spring-boot-starter-cache`)
- Spring Data Redis (`spring-boot-starter-data-redis`)
- Spring Boot Actuator (`spring-boot-starter-actuator`)

### 2.2 文档与 API

- SpringDoc OpenAPI + Swagger UI
- 依赖: `springdoc-openapi-starter-webmvc-ui:2.6.0`

### 2.3 数据与存储

- 默认数据库: H2 内存数据库
- ORM: Hibernate (via Spring Data JPA)
- 可选缓存后端: Redis（通过 profile 切换）

### 2.4 测试

- Spring Boot Test (`spring-boot-starter-test`)
- Spring Security Test (`spring-security-test`)

## 3. 项目结构

```text
spring-family-bucket/
├── pom.xml
├── README.md
├── 项目文档.md
├── src/
│   ├── main/
│   │   ├── java/com/example/springfamily/
│   │   │   ├── SpringFamilyBucketApplication.java
│   │   │   ├── config/
│   │   │   │   └── SecurityConfig.java
│   │   │   ├── controller/
│   │   │   │   └── UserProfileController.java
│   │   │   ├── dto/
│   │   │   │   ├── UserProfileRequest.java
│   │   │   │   └── UserProfileResponse.java
│   │   │   ├── entity/
│   │   │   │   └── UserProfile.java
│   │   │   ├── exception/
│   │   │   │   ├── ApiExceptionHandler.java
│   │   │   │   └── ResourceNotFoundException.java
│   │   │   ├── repository/
│   │   │   │   └── UserProfileRepository.java
│   │   │   └── service/
│   │   │       └── UserProfileService.java
│   │   └── resources/
│   │       ├── application.yml
│   │       └── application-redis.yml
│   └── test/
│       └── java/com/example/springfamily/
│           ├── SpringFamilyBucketApplicationTests.java
│           └── controller/
│               └── UserProfileControllerTest.java
└── target/
```

## 4. 核心功能模块说明

- `controller`: 对外 REST 接口（当前示例为 `/api/users`）
- `service`: 业务逻辑层，包含缓存注解
- `repository`: 数据访问层（JPA Repository）
- `entity`: 数据实体映射
- `dto`: 请求/响应对象与参数约束
- `config`: 安全配置（HTTP Basic 鉴权）
- `exception`: 统一异常处理

## 5. 配置说明

### 5.1 默认配置 (`application.yml`)

- 数据源: H2 内存库
- 缓存模式: `spring.cache.type=simple`（本地内存）
- Redis 连接参数已预置（默认不启用 Redis 缓存）
- 管理端点暴露: `health, info, metrics, env`
- Swagger 路径: `/swagger-ui.html`
- 默认账号密码:
  - username: `admin`
  - password: `admin123`

### 5.2 Redis 缓存配置 (`application-redis.yml`)

- 当激活 `redis` profile 时，缓存类型切换为 `redis`

## 6. 运行与启动

### 6.1 环境要求

- JDK 17+
- Maven 3.9+

### 6.2 本地启动

```bash
cd /Volumes/sk801/codecollection/java/spring-family-bucket
mvn spring-boot:run
```

### 6.3 启用 Redis 缓存启动（可选）

```bash
cd /Volumes/sk801/codecollection/java/spring-family-bucket
mvn spring-boot:run -Dspring-boot.run.profiles=redis
```

### 6.4 构建与测试

```bash
cd /Volumes/sk801/codecollection/java/spring-family-bucket
mvn clean package
mvn test
```

## 7. 访问地址

- Swagger UI: `http://localhost:8080/swagger-ui.html`
- OpenAPI JSON: `http://localhost:8080/v3/api-docs`
- 健康检查: `http://localhost:8080/actuator/health`
- H2 Console: `http://localhost:8080/h2-console`

## 8. 接口调用示例

```bash
# 查询用户列表
curl -u admin:admin123 http://localhost:8080/api/users

# 新增用户
curl -u admin:admin123 -X POST http://localhost:8080/api/users \
  -H "Content-Type: application/json" \
  -d '{"name":"Alice","email":"alice@example.com","age":28}'
```

## 9. 已验证状态

- `mvn test` 已通过（3 个测试，0 失败）
- 默认 profile 可正常加载 H2/JPA/Security/Actuator/Swagger
